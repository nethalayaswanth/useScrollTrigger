var e=require("react");function t(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,t}var n=/*#__PURE__*/t(e);function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function i(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t.indexOf(n=o[r])>=0||(i[n]=e[n]);return i}var o=function(e,t,n){return Math.max(t,Math.min(e,n))};function s(){var e=arguments;return function(t){[].slice.call(e).forEach(function(e){"function"==typeof e?e(t):null!=e&&(e.current=t)})}}function u(e,t,n){return e[t]?e[t][0]?e[t][0][n]:e[t][n]:"contentBoxSize"===t?e.contentRect["inlineSize"===n?"width":"height"]:void 0}var c=["root"],a=["node"],l=/*#__PURE__*/function(){function e(){this.nodes=new Map,this.visibleNodes=new Map,this.animatingNodes=new Set,this.observer=null,this.scroller=null,this.direction=null,this.mounted=!1,this.prevYPosition=0,this.scroll=!0}var t=e.prototype;return t.setScrollDirection=function(e){this.direction=e<this.prevYPosition?"down":"up",this.prevYPosition=e},t.handleIntersecting=function(e){var t=e.target;if(e.isIntersecting)this.visibleNodes.set(t,e),t.classList.add("trigger");else{var n;if(!this.direction)return;var r="up"===this.direction;t.classList.remove("trigger"),t.style.setProperty("--trigger",r?" 1":" 0"),t.style.setProperty("--trigger-px",r&&null!=(n=t.dataset.end)?n:"0")}},t.updateEntries=function(e){var t=this;this.visibleNodes=new Map,e.forEach(function(e){t.handleIntersecting(e)})},t.caluclatePosition=function(e){if(!e)return[0,0];var t=e.boundingClientRect,n=t.top;if(!e.rootBounds)return[0,0];var r=e.rootBounds.height-40,i=0,s=r+t.height,u=e.target;u.dataset.start&&(i=parseInt(u.dataset.start,10)),u.dataset.end&&(s=parseInt(u.dataset.end,10));var c=s-i,a=r-n-i;return[o(a/c,0,1),o(a,0,c)]},t.update=function(){var e=this;this.visibleNodes.forEach(function(t,n){var r=n.style,i=e.caluclatePosition(t),o=i[0],s=i[1],u="up"===e.direction,c=e.nodes.get(n),a=c.onStart,l=c.onProgress,f=c.onEnd;o>0&&o<1?(e.animatingNodes.has(n)||(e.animatingNodes.add(n),u&&a({node:n,entry:t,scrollingUp:u,progress:o})),l({node:n,entry:t,scrollingUp:u,progress:o})):0!==o&&1!==o||e.animatingNodes.has(n)&&(1===o&&f({node:n,entry:t,scrollingUp:u,progress:o}),e.animatingNodes.delete(n)),r.setProperty("--trigger",""+o),r.setProperty("--trigger-px",""+s)})},t.initObserver=function(t){var n=this,o=t.root,s=i(t,c);this.scroller=o,this.observer=new IntersectionObserver(function(e,t){n.updateEntries(e),n.update()},r({root:o,rootMargin:e.ROOTMARGINEXT+"px 0px"},s))},t.init=function(e){return this.initObserver(e),this.observeAll(),this.onScroll(),this},t.add=function(e){var t=e.node,n=i(e,a);this.nodes.set(t,n),t.style.setProperty("--trigger","0"),t.style.setProperty("--trigger-px","0"),this.observe(t)},t.observe=function(e){this.observer&&this.observer.observe(e)},t.unobserve=function(e){this.observer&&this.observer.unobserve(e)},t.destroy=function(){this.observer&&this.observer.disconnect()},t.observeAll=function(){var e=this;this.nodes.forEach(function(t,n){e.observe(n)})},t.onScroll=function(e){var t=this;if(e&&this.mounted){if(!(e.target instanceof HTMLElement||e.target instanceof Window))return;var n=e.target instanceof HTMLElement?e.target.scrollTop:e.target instanceof Document?e.target.documentElement.scrollTop:e.target instanceof Window?e.target.scrollX:0;this.mounted=!0,this.setScrollDirection(n)}this.visibleNodes&&0!==this.visibleNodes.size&&this.visibleNodes.forEach(function(e,n){t.unobserve(n),t.observe(n)})},e}();l.ROOTMARGINEXT=0;var f="undefined"!=typeof window?e.useLayoutEffect:e.useEffect;function d(t,n){var r=e.useRef(null),i=e.useRef(null);i.current=n;var o=e.useRef(null),s=e.useCallback(function(){var e=i.current,n=o.current||(e?e instanceof Element?e:e.current:null);r.current&&r.current.element===n&&r.current.subscriber===t||(r.current&&r.current.cleanup&&r.current.cleanup(),r.current={element:n,subscriber:t,cleanup:n?t(n):void 0})},[t]);return f(function(){s()}),f(function(){return function(){r.current&&r.current.cleanup&&(r.current.cleanup(),r.current=null)}},[]),e.useCallback(function(e){o.current=e,s()},[s])}var v=["name","ref","style"],h=function(t){var o,c,a=t.root,f=t.onScroll,h=e.useCallback(function(){return a?"string"==typeof a?document.getElementById(a):a instanceof HTMLElement?a:a.current:document.documentElement},[a]),g=e.useState(function(){return new l})[0],b=(c=n.useRef(o=f),n.useEffect(function(){c.current=o}),c);e.useLayoutEffect(function(){g.init({root:h()})},[h,g]);var p=d(function(e){var t=function(e){g.onScroll(e),null==b.current||b.current(e)};return e.addEventListener("scroll",t,{passive:!0}),function(){g.destroy(),e.removeEventListener("scroll",t,{passive:!0})}},h()),y=function(t){void 0===t&&(t={});var n=t.onResize,r=e.useRef(void 0);r.current=n;var i=t.round||Math.round,o=e.useRef(),s=e.useState({width:void 0,height:void 0}),c=s[0],a=s[1],l=e.useRef(!1);e.useEffect(function(){return l.current=!1,function(){l.current=!0}},[]);var f=e.useRef({width:void 0,height:void 0}),v=d(e.useCallback(function(e){return o.current&&o.current.box===t.box&&o.current.round===i||(o.current={box:t.box,round:i,instance:new ResizeObserver(function(e){var n=e[0],o="border-box"===t.box?"borderBoxSize":"device-pixel-content-box"===t.box?"devicePixelContentBoxSize":"contentBoxSize",s=u(n,o,"inlineSize"),c=u(n,o,"blockSize"),d=s?i(s):void 0,v=c?i(c):void 0;if(f.current.width!==d||f.current.height!==v){var h={width:d,height:v};f.current.width=d,f.current.height=v,r.current?r.current(h):l.current||a(h)}})}),o.current.instance.observe(e,{box:t.box}),function(){o.current&&o.current.instance.unobserve(e)}},[t.box,i]),t.ref);return e.useMemo(function(){return{ref:v,width:c.width,height:c.height}},[v,c.width,c.height])}({ref:h(),onResize:e.useCallback(function(){g.observeAll()},[g])}).ref;return{register:function(e){var t=e.name,n=e.ref,o=e.style,u=i(e,v);return{id:""+t,ref:s(function(e){e&&function(e){var t=e.node,n=e.end;t.dataset.start=e.start,t.dataset.end=n,g.add(e)}(r({node:e,name:t},u))},n),style:r({},o)}},scrollerRef:e.useMemo(function(){return s(p,y)},[p,y])}};exports.default=h,exports.useScrollTrigger=h;
//# sourceMappingURL=index.cjs.map
